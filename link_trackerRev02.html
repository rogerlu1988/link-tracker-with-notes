<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>📁 Link Tracker with Notes</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <div class="max-w-xl mx-auto mt-10 bg-white p-8 rounded-xl shadow-lg">
    <h1 class="text-2xl font-bold text-gray-800 mb-6">📁 Link Tracker with Notes</h1>

    <form id="linkForm" class="space-y-4">
      <div>
        <label for="url" class="block font-semibold mb-1">Link URL</label>
        <input type="text" id="url" name="url" required placeholder="e.g. C:\\Project\\myfile.txt"
          class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"/>
      </div>

      <div>
        <label for="note" class="block font-semibold mb-1">Description Note</label>
        <textarea id="note" name="note" rows="2" required placeholder="e.g. Altium project for surge stopper"
          class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
      </div>

      <button type="submit"
        class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition">
        Add Link
      </button>
    </form>

    <div class="mt-4">
      <label class="block font-semibold text-sm mb-1 text-gray-700">📂 Load Links from File</label>
      <div class="flex gap-2">
        <input type="file" id="fileInput" accept=".txt"
          class="flex-1 border rounded px-2 py-1 text-sm" />
        <button id="loadBtn"
          class="bg-green-600 text-white px-4 rounded hover:bg-green-700 text-sm">
          Load File
        </button>
      </div>
    </div>

    <div class="mt-8">
      <h2 class="text-lg font-semibold text-gray-700 mb-4">🔗 Saved Links</h2>
      <div id="linkList" class="space-y-4"></div>
    </div>
  </div>

  <script>
    const form = document.getElementById("linkForm");
    const linkList = document.getElementById("linkList");
    const fileInput = document.getElementById("fileInput");
    const loadBtn = document.getElementById("loadBtn");

    function saveToLocalStorage(data) {
      localStorage.setItem("savedLinks", JSON.stringify(data));
    }

    function loadFromLocalStorage() {
      const saved = localStorage.getItem("savedLinks");
      return saved ? JSON.parse(saved) : [];
    }

    function renderLinks() {
      const links = loadFromLocalStorage();
      linkList.innerHTML = "";

      links.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "bg-gray-50 p-4 rounded border";

        const linkTag = document.createElement("a");
        linkTag.href = item.url;
        linkTag.textContent = item.url;
        linkTag.className = "text-blue-600 underline font-medium break-all";
        linkTag.target = "_blank";

        const note = document.createElement("p");
        note.textContent = item.note;
        note.className = "text-sm text-gray-700 mt-1";

        const delBtn = document.createElement("button");
        delBtn.textContent = "Delete";
        delBtn.className = "mt-2 text-red-500 hover:underline text-sm";
        delBtn.onclick = () => {
          links.splice(index, 1);
          saveToLocalStorage(links);
          renderLinks();
        };

        div.appendChild(linkTag);
        div.appendChild(note);
        div.appendChild(delBtn);
        linkList.appendChild(div);
      });
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const url = form.url.value.trim();
      const note = form.note.value.trim();

      if (!url || !note) return;

      const links = loadFromLocalStorage();
      links.push({ url, note });
      saveToLocalStorage(links);
      renderLinks();
      form.reset();
    });

    loadBtn.addEventListener("click", () => {
      const file = fileInput.files[0];
      if (!file) {
        alert("Please choose a JSON file first.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = JSON.parse(event.target.result);
          if (Array.isArray(data)) {
            saveToLocalStorage(data);
            renderLinks();
          } else {
            alert("Invalid format: Expected a JSON array.");
          }
        } catch (err) {
          alert("Error reading file: " + err.message);
        }
      };
      reader.readAsText(file);
    });

    document.addEventListener("DOMContentLoaded", renderLinks);
  </script>
</body>
</html>
